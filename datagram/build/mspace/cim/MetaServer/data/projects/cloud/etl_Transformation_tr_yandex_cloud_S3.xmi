<?xml version="1.0" encoding="ASCII"?>
<etl:Transformation xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:etl="http://www.neoflex.ru/meta/etl" name="tr_yandex_cloud_S3" label="tr_yandex_cloud_S3" sparkVersion="SPARK3" description="&#x424;&#x43e;&#x440;&#x43c;&#x438;&#x440;&#x43e;&#x432;&#x430;&#x43d;&#x438;&#x435; &#x442;&#x430;&#x431;&#x43b;&#x438;&#x446;&#x44b; &#x444;&#x430;&#x43a;&#x442;&#x43e;&#x432; &#x43f;&#x43e;&#x432;&#x44b;&#x448;&#x435;&#x43d;&#x438;&#x44f; &#x417;&#x41f; &#x437;&#x430; &#x43f;&#x440;&#x435;&#x434;&#x44b;&#x434;&#x443;&#x449;&#x438;&#x439; &#x433;&#x43e;&#x434;" jsonView="{&quot;cells&quot;:[{&quot;type&quot;:&quot;devs.transformation.CSVSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:30,&quot;y&quot;:90},&quot;angle&quot;:0,&quot;id&quot;:&quot;49ee6a05-8365-4f27-92e2-5eb2413ea31f&quot;,&quot;name&quot;:&quot;employeepayhistory&quot;,&quot;z&quot;:1,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;employeepayhistory&quot;}}},{&quot;type&quot;:&quot;devs.transformation.CSVSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:240,&quot;y&quot;:240},&quot;angle&quot;:0,&quot;id&quot;:&quot;1babaca6-f39c-4915-8ba5-926a91422844&quot;,&quot;name&quot;:&quot;person&quot;,&quot;z&quot;:2,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;person&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SparkSQL&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;sqlin&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}},{&quot;id&quot;:&quot;0&quot;,&quot;multiple&quot;:true,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;Salary&quot;,&quot;visibility&quot;:&quot;visible&quot;},&quot;circle&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}]},&quot;position&quot;:{&quot;x&quot;:240,&quot;y&quot;:90},&quot;angle&quot;:0,&quot;id&quot;:&quot;e90b7f33-482f-49d5-b4a2-08fe4f6bba57&quot;,&quot;name&quot;:&quot;lastYear&quot;,&quot;z&quot;:3,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;lastYear&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Join&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;,&quot;join&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;join&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;join&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:416,&quot;y&quot;:172},&quot;angle&quot;:0,&quot;id&quot;:&quot;5f9f70ac-f212-4cf5-aed1-fc70b9d2bc57&quot;,&quot;name&quot;:&quot;joinSalary&quot;,&quot;z&quot;:4,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;joinSalary&quot;}}},{&quot;type&quot;:&quot;devs.transformation.LocalTarget&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:630,&quot;y&quot;:270},&quot;angle&quot;:0,&quot;id&quot;:&quot;235d8d59-cec0-4308-b9ef-b75bfaa6a49c&quot;,&quot;name&quot;:&quot;S3lastYearORC&quot;,&quot;z&quot;:5,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;S3lastYearORC&quot;}}},{&quot;type&quot;:&quot;devs.transformation.CSVTarget&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:630,&quot;y&quot;:60},&quot;angle&quot;:0,&quot;id&quot;:&quot;c4abf107-4384-4c02-bd3b-e09ac02aea18&quot;,&quot;name&quot;:&quot;S3lastYearCSV&quot;,&quot;z&quot;:6,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;S3lastYearCSV&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;49ee6a05-8365-4f27-92e2-5eb2413ea31f&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;e90b7f33-482f-49d5-b4a2-08fe4f6bba57&quot;,&quot;port&quot;:&quot;0&quot;},&quot;id&quot;:&quot;534cc10e-8f2b-441a-8ebb-5121eab41add&quot;,&quot;z&quot;:7,&quot;name&quot;:&quot;a4d2dc97-7276-4191-8464-e0751d92fdb9&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;a4d2dc97-7276-4191-8464-e0751d92fdb9&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;e90b7f33-482f-49d5-b4a2-08fe4f6bba57&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;5f9f70ac-f212-4cf5-aed1-fc70b9d2bc57&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;014def9c-2d3f-451d-91a3-e6e5c7537963&quot;,&quot;z&quot;:8,&quot;name&quot;:&quot;9bdfab02-b2ac-4b56-b920-b4d3006b8638&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;9bdfab02-b2ac-4b56-b920-b4d3006b8638&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;1babaca6-f39c-4915-8ba5-926a91422844&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;5f9f70ac-f212-4cf5-aed1-fc70b9d2bc57&quot;,&quot;port&quot;:&quot;join&quot;},&quot;id&quot;:&quot;095c715c-aa45-4d32-8558-410f32700a74&quot;,&quot;z&quot;:9,&quot;name&quot;:&quot;89ff4588-9bbd-4387-be23-1e3eed6f62b2&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;89ff4588-9bbd-4387-be23-1e3eed6f62b2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;5f9f70ac-f212-4cf5-aed1-fc70b9d2bc57&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;235d8d59-cec0-4308-b9ef-b75bfaa6a49c&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;d325641a-9963-4c2d-80f2-2549af4c7279&quot;,&quot;z&quot;:10,&quot;name&quot;:&quot;0188c10a-f1c0-4a71-b9dd-0bae4189c444&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;0188c10a-f1c0-4a71-b9dd-0bae4189c444&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;5f9f70ac-f212-4cf5-aed1-fc70b9d2bc57&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;c4abf107-4384-4c02-bd3b-e09ac02aea18&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;eafe9891-c783-4b0d-9eb2-66e413a15c57&quot;,&quot;z&quot;:11,&quot;name&quot;:&quot;3f158096-9be8-4217-93de-d53d6f0c012c&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;3f158096-9be8-4217-93de-d53d6f0c012c&quot;}}}]}">
  <targets xsi:type="etl:LocalTarget" name="S3lastYearORC" label="S3lastYearORC" localFileName="s3a://datagram/forTransformation/lastYearORC" localFileFormat="ORC" formatName="" saveMode="OVERWRITE">
    <inputPort name="Local_7in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="personName" dataTypeDomain="STRING"/>
      <fields name="rate" dataTypeDomain="DOUBLE"/>
      <fields name="ratechangedate" dataTypeDomain="STRING"/>
    </inputPort>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="businessentityid" targetColumnName="businessentityid"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="personName" targetColumnName="personName"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="rate" targetColumnName="rate"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="ratechangedate" targetColumnName="ratechangedate"/>
  </targets>
  <targets xsi:type="etl:CSVTarget" name="S3lastYearCSV" label="S3lastYearCSV" path="s3a://datagram/forTransformation/lastYearCSV" header="true" quote="&quot;" escape="\">
    <inputPort name="CSV_9in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="personName" dataTypeDomain="STRING"/>
      <fields name="rate" dataTypeDomain="DOUBLE"/>
      <fields name="ratechangedate" dataTypeDomain="STRING"/>
    </inputPort>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="businessentityid" targetColumnName="businessentityid"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="personName" targetColumnName="personName"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="rate" targetColumnName="rate"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="ratechangedate" targetColumnName="ratechangedate"/>
  </targets>
  <transformationSteps xsi:type="etl:SparkSQL" name="lastYear" label="lastYear" statement="select &#xA;    businessentityid,&#xA;    rate,&#xA;    ratechangedate&#xA;from Salary&#xA;where months_between(cast(&amp;currentDate as date), ratechangedate, true) &lt;= 12">
    <outputPort name="Spark_SQL_1out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="rate" dataTypeDomain="DOUBLE"/>
      <fields name="ratechangedate" dataTypeDomain="STRING"/>
    </outputPort>
    <sqlPorts name="Salary" alias="Salary">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="rate" dataTypeDomain="DOUBLE"/>
      <fields name="ratechangedate" dataTypeDomain="STRING"/>
    </sqlPorts>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Join" name="joinSalary" label="joinSalary" checkpoint="true" joinType="LEFT">
    <outputPort name="Join_4out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.1/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="personName" dataTypeDomain="STRING" sourceFields="//@transformationSteps.1/@joineePort/@fields.1 //@transformationSteps.1/@joineePort/@fields.2 //@transformationSteps.1/@joineePort/@fields.3" expression="concat( &#xA;    if(_2.firstname is null, '', _2.firstname), &#xA;    ' ', &#xA;    if(_2.middlename is null, '', _2.middlename), &#xA;    ' ',&#xA;    if(_2.lastname is null, '', _2.lastname) &#xA;)" fieldOperationType="SQL"/>
      <fields xsi:type="etl:ProjectionField" name="rate" dataTypeDomain="DOUBLE" sourceFields="//@transformationSteps.1/@inputPort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="ratechangedate" dataTypeDomain="STRING" sourceFields="//@transformationSteps.1/@inputPort/@fields.2"/>
    </outputPort>
    <inputPort name="Join_4in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="rate" dataTypeDomain="DOUBLE"/>
      <fields name="ratechangedate" dataTypeDomain="STRING"/>
    </inputPort>
    <joineePort name="Join_4join">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="firstname" dataTypeDomain="STRING"/>
      <fields name="lastname" dataTypeDomain="STRING"/>
      <fields name="middlename" dataTypeDomain="STRING"/>
    </joineePort>
    <keyFields>businessentityid</keyFields>
    <joineeKeyFields>businessentityid</joineeKeyFields>
  </transformationSteps>
  <sources xsi:type="etl:CSVSource" name="employeepayhistory" label="employeepayhistory" path="s3a://datagram/forTransformation/employeepayhistory.csv" header="true" quote="&quot;" escape="\">
    <outputPort name="CSV_0out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="rate" dataTypeDomain="DOUBLE"/>
      <fields name="ratechangedate" dataTypeDomain="STRING"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:CSVSource" name="person" label="person" path="s3a://datagram/forTransformation/person.csv" header="true" quote="&quot;" escape="\">
    <outputPort name="CSV_3out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="firstname" dataTypeDomain="STRING"/>
      <fields name="lastname" dataTypeDomain="STRING"/>
      <fields name="middlename" dataTypeDomain="STRING"/>
    </outputPort>
  </sources>
  <transitions name="a4d2dc97-7276-4191-8464-e0751d92fdb9" start="//@sources.0/@outputPort" finish="//@transformationSteps.0/@sqlPorts.0"/>
  <transitions name="9bdfab02-b2ac-4b56-b920-b4d3006b8638" start="//@transformationSteps.0/@outputPort" finish="//@transformationSteps.1/@inputPort"/>
  <transitions name="89ff4588-9bbd-4387-be23-1e3eed6f62b2" start="//@sources.1/@outputPort" finish="//@transformationSteps.1/@joineePort"/>
  <transitions name="0188c10a-f1c0-4a71-b9dd-0bae4189c444" start="//@transformationSteps.1/@outputPort" finish="//@targets.0/@inputPort"/>
  <transitions name="3f158096-9be8-4217-93de-d53d6f0c012c" start="//@transformationSteps.1/@outputPort" finish="//@targets.1/@inputPort"/>
  <auditInfo changeUser="admin" changeDateTime="2021-08-20T09:19:26.440+0000" createUser="admin" createDateTime="2021-07-16T07:24:53.479+0000"/>
</etl:Transformation>
