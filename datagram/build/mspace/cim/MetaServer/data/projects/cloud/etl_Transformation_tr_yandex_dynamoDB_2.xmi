<?xml version="1.0" encoding="ASCII"?>
<etl:Transformation xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:etl="http://www.neoflex.ru/meta/etl" name="tr_yandex_dynamoDB_2" label="tr_yandex_dynamoDB_2" sparkVersion="SPARK3" jsonView="{&quot;cells&quot;:[{&quot;type&quot;:&quot;devs.transformation.LocalSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:126,&quot;y&quot;:140},&quot;angle&quot;:0,&quot;id&quot;:&quot;be4c447c-e315-49c2-b571-3130150a6e53&quot;,&quot;name&quot;:&quot;lastYearDynamoDB&quot;,&quot;z&quot;:1,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;lastYearDynamoDB&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SparkSQL&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;sqlin&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}},{&quot;id&quot;:&quot;0&quot;,&quot;multiple&quot;:true,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;UpdateTable&quot;,&quot;visibility&quot;:&quot;visible&quot;},&quot;circle&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}]},&quot;position&quot;:{&quot;x&quot;:295,&quot;y&quot;:144},&quot;angle&quot;:0,&quot;id&quot;:&quot;f0a7484e-3bd7-4219-a149-9e400193e2a5&quot;,&quot;name&quot;:&quot;SparkSQL&quot;,&quot;z&quot;:2,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;SparkSQL&quot;}}},{&quot;type&quot;:&quot;devs.transformation.LocalTarget&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:453,&quot;y&quot;:147},&quot;angle&quot;:0,&quot;id&quot;:&quot;c2f9264d-955b-485e-b8dd-c885784ea14c&quot;,&quot;name&quot;:&quot;setlastYearDynamoDB&quot;,&quot;z&quot;:3,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;setlastYearDynamoDB&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;be4c447c-e315-49c2-b571-3130150a6e53&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;f0a7484e-3bd7-4219-a149-9e400193e2a5&quot;,&quot;port&quot;:&quot;0&quot;},&quot;id&quot;:&quot;f827ead0-56b8-4175-9451-80cd82ebcfd6&quot;,&quot;z&quot;:4,&quot;name&quot;:&quot;f4771a18-24b9-44e9-a2ad-6d8278cb9766&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;f4771a18-24b9-44e9-a2ad-6d8278cb9766&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;f0a7484e-3bd7-4219-a149-9e400193e2a5&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;c2f9264d-955b-485e-b8dd-c885784ea14c&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;28972912-88ae-4f52-9f0a-4cb5c3cc3788&quot;,&quot;z&quot;:5,&quot;name&quot;:&quot;a92139bb-6b8f-42c9-9a64-918a4edd8871&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;a92139bb-6b8f-42c9-9a64-918a4edd8871&quot;}}}]}">
  <targets xsi:type="etl:LocalTarget" name="setlastYearDynamoDB" label="setlastYearDynamoDB" localFileFormat="OTHER" formatName="dynamodb">
    <inputPort name="Local_3in">
      <fields name="personName" dataTypeDomain="STRING"/>
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="rate" dataTypeDomain="DOUBLE"/>
      <fields name="ratechangedate" dataTypeDomain="STRING"/>
    </inputPort>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="personName" targetColumnName="personName"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="businessentityid" targetColumnName="businessentityid"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="rate" targetColumnName="rate"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="ratechangedate" targetColumnName="ratechangedate"/>
    <options key="tableName" value="lastYear"/>
    <options key="throughput" value="1000"/>
  </targets>
  <transformationSteps xsi:type="etl:SparkSQL" name="SparkSQL" label="SparkSQL" statement="select &#xA;    personName,&#xA;    businessentityid,&#xA;    rate,&#xA;    ratechangedate&#xA;from UpdateTable&#xA;Union All&#xA;select &#xA;    personName,&#xA;    businessentityid + 20,&#xA;    rate,&#xA;    ratechangedate&#xA;from UpdateTable" sampleSize="1000">
    <outputPort name="Spark_SQL_1out">
      <fields name="personName" dataTypeDomain="STRING"/>
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="rate" dataTypeDomain="DOUBLE"/>
      <fields name="ratechangedate" dataTypeDomain="STRING"/>
    </outputPort>
    <sqlPorts name="UpdateTable" alias="UpdateTable"/>
  </transformationSteps>
  <sources xsi:type="etl:LocalSource" name="lastYearDynamoDB" label="lastYearDynamoDB" schemaOnRead="true" localFileFormat="OTHER" formatName="dynamodb">
    <outputPort name="Local_0out"/>
    <options key="tableName" value="lastYear"/>
    <options key="throughput" value="1000"/>
  </sources>
  <transitions name="f4771a18-24b9-44e9-a2ad-6d8278cb9766" start="//@sources.0/@outputPort" finish="//@transformationSteps.0/@sqlPorts.0"/>
  <transitions name="a92139bb-6b8f-42c9-9a64-918a4edd8871" start="//@transformationSteps.0/@outputPort" finish="//@targets.0/@inputPort"/>
  <auditInfo changeUser="admin" changeDateTime="2021-08-20T09:19:26.553+0000" createUser="admin" createDateTime="2021-08-19T07:25:09.647+0000"/>
</etl:Transformation>
